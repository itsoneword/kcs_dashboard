import{f as L,a as _,t as Ce}from"../chunks/z1_h_S-m.js";import{i as Ne}from"../chunks/CKvl8f00.js";import{p as Oe,o as Je,t as y,g as e,a as De,b as c,s as a,m as h,c as i,$ as Ie,r as o,f as qe,i as ze}from"../chunks/DO95TrpH.js";import{h as Be,e as Y,s as u}from"../chunks/DePN81sB.js";import{i as R}from"../chunks/i89i58Dp.js";import{e as Me,i as We}from"../chunks/KzdxLMOR.js";import{r as G,s as He}from"../chunks/B0rVqcg2.js";import{b as Q}from"../chunks/CoGRtSRs.js";import{b as Ke}from"../chunks/DWPWRXnJ.js";import{p as Ue}from"../chunks/Bfc47y5P.js";import{g as V}from"../chunks/BvPgAsJ_.js";import{a as X}from"../chunks/VlzhU-cE.js";const S={title:"Sign in to your account",subtitle:"KCS Performance Tracking Portal",emailLabel:"Email address",passwordLabel:"Password",submitButton:"Sign in",needAccount:"Need an account?",alreadyHaveAccount:"Already have an account?"},w={title:"Create your account",description:"Join the KCS Performance Tracking Portal to monitor and improve your team's performance. Select your role below to get started with the appropriate permissions.",nameLabel:"Full Name",emailLabel:"Email address",passwordLabel:"Password",roleLabel:"Your Role",submitButton:"Register",roleDescriptions:{coach:"Track individual performance metrics and provide feedback to team members.",lead:"Oversee team performance and coordinate with coaches to improve results.",manager:"Access comprehensive analytics and manage organizational performance strategies."}},je=[{value:"coach",label:"Coach"},{value:"lead",label:"Lead"}],A={login:{invalidCredentials:"Invalid email or password. Please try again.",serverError:"Server error. Please try again later.",rateLimited:"Too many login attempts. Please wait a moment and try again."},register:{emailTaken:"This email is already registered. Please use a different email or sign in.",passwordTooWeak:"Password is too weak. Please use at least 8 characters including a number and a special character.",serverError:"Server error. Please try again later."}};var Fe=L("<option> </option>"),Ye=L('<div><label for="name" class="form-label"> </label> <input id="name" name="name" type="text" required class="form-input" placeholder="Enter your full name"/></div> <div><label for="role" class="form-label"> </label> <select id="role" name="role" required class="form-input"></select> <p class="mt-1 text-xs text-gray-500"> </p></div> <div class="mt-4"><p class="text-sm text-gray-600"> </p></div>',1),Ge=L('<p class="mt-1 text-xs text-gray-500">Password must be at least 6 characters</p>'),Qe=L('<button class="absolute top-0 right-0 px-2 py-1 text-xs text-red-500">Clear</button>'),Ve=L('<div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative"><span class="block sm:inline"> </span> <!></div>'),Xe=L('<div class="mt-4 p-3 bg-gray-100 rounded text-xs font-mono overflow-auto max-h-48"><h4 class="font-bold mb-1">Debug Information</h4> <pre> </pre></div>'),Ze=L('<div class="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>'),ea=L('<div class="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"><div class="max-w-md w-full space-y-8"><div><h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900"> </h2> <p class="mt-2 text-center text-sm text-gray-600"> </p></div> <form class="mt-8 space-y-6"><div class="space-y-4"><!> <div><label for="email" class="form-label"> </label> <input id="email" name="email" type="email" autocomplete="email" required class="form-input" placeholder="Enter your email"/></div> <div><label for="password" class="form-label"> </label> <input id="password" name="password" type="password" required class="form-input" placeholder="Enter your password"/> <!></div></div> <!> <!> <div><button type="submit" class="btn-primary w-full flex justify-center py-3"><!></button></div> <div class="text-center"><button type="button" class="text-primary-600 hover:text-primary-500 text-sm"> </button></div></form></div></div>');function ua(ce,ve){Oe(ve,!1);let P=h(""),x=h(""),p=h(!1),v=h(""),f=h(!1),E=h(""),k=h("coach"),b=h(!1),s=h("");Je(()=>{{const t=new URLSearchParams(window.location.search);if(a(b,t.has("debug")),e(b)){a(s,`User Agent: ${navigator.userAgent}
`),a(s,e(s)+`Window Size: ${window.innerWidth}x${window.innerHeight}
`),a(s,e(s)+`Local Storage Available: ${!!localStorage}
`);try{const l=localStorage.getItem("auth_token");a(s,e(s)+`Auth Token Present: ${!!l}
`);const m=localStorage.getItem("user");a(s,e(s)+`User Data Present: ${!!m}
`)}catch(l){a(s,e(s)+`Error accessing localStorage: ${l.message}
`)}}}return X.subscribe(t=>{e(b)&&a(s,e(s)+`Auth State: ${JSON.stringify(t)}
`),t.isAuthenticated&&!t.isLoading&&V("/dashboard")})});async function me(){var r,t,l,m,g,n;if(!e(P)||!e(x)){a(v,"Please fill in all fields");return}a(p,!0),a(v,"");try{const d=e(P).toLowerCase().trim();e(b)&&a(s,e(s)+`Login attempt: ${d}
`),await X.login(d,e(x)),V("/dashboard")}catch(d){e(b)&&(a(s,e(s)+`Login error: ${JSON.stringify(d)}
`),a(s,e(s)+`Response status: ${(r=d.response)==null?void 0:r.status}
`),a(s,e(s)+`Response data: ${JSON.stringify((t=d.response)==null?void 0:t.data)}
`)),((l=d.response)==null?void 0:l.status)===401?a(v,A.login.invalidCredentials):((m=d.response)==null?void 0:m.status)===429?a(v,A.login.rateLimited):d.response?a(v,((n=(g=d.response)==null?void 0:g.data)==null?void 0:n.error)||A.login.serverError):a(v,"Network error. Please check your connection.")}finally{a(p,!1)}}async function ue(){var r,t,l,m,g;if(!e(P)||!e(x)||!e(E)){a(v,"Please fill in all fields");return}if(e(x).length<6){a(v,A.register.passwordTooWeak);return}a(p,!0),a(v,"");try{const n=e(P).toLowerCase().trim();e(b)&&a(s,e(s)+`Register attempt: ${n}
`),await X.register(n,e(x),e(E),e(k)),V("/dashboard")}catch(n){e(b)&&(a(s,e(s)+`Register error: ${JSON.stringify(n)}
`),a(s,e(s)+`Response status: ${(r=n.response)==null?void 0:r.status}
`),a(s,e(s)+`Response data: ${JSON.stringify((t=n.response)==null?void 0:t.data)}
`)),((l=n.response)==null?void 0:l.status)===409?a(v,A.register.emailTaken):n.response?a(v,((g=(m=n.response)==null?void 0:m.data)==null?void 0:g.error)||A.register.serverError):a(v,"Network error. Please check your connection.")}finally{a(p,!1)}}function pe(){a(f,!e(f)),a(v,""),a(P,""),a(x,""),a(E,""),a(k,"coach")}Ne();var D=ea();Be(r=>{y(()=>Ie.title=`${e(f)?"Register":"Login"} - KCS Portal`)});var Z=i(D),I=i(Z),q=i(I),fe=i(q,!0);o(q);var ee=c(q,2),be=i(ee,!0);o(ee),o(I);var z=c(I,2),B=i(z),ae=i(B);{var ge=r=>{var t=Ye(),l=qe(t),m=i(l),g=i(m,!0);o(m);var n=c(m,2);G(n),o(l);var d=c(l,2),$=i(d),Re=i($,!0);o($);var C=c($,2);y(()=>{e(k),ze(()=>{e(p)})}),Me(C,5,()=>je,We,(N,F)=>{var O=Fe(),de={},Te=i(O,!0);o(O),y(()=>{de!==(de=e(F).value)&&(O.value=(O.__value=e(F).value)??""),u(Te,e(F).label)}),_(N,O)}),o(C);var ie=c(C,2),Ae=i(ie,!0);o(ie),o(d);var le=c(d,2),ne=i(le),Ee=i(ne,!0);o(ne),o(le),y(()=>{u(g,w.nameLabel),n.disabled=e(p),u(Re,w.roleLabel),C.disabled=e(p),u(Ae,w.roleDescriptions[e(k)]),u(Ee,w.description)}),Q(n,()=>e(E),N=>a(E,N)),Ke(C,()=>e(k),N=>a(k,N)),_(r,t)};R(ae,r=>{e(f)&&r(ge)})}var M=c(ae,2),W=i(M),_e=i(W,!0);o(W);var H=c(W,2);G(H),o(M);var re=c(M,2),K=i(re),he=i(K,!0);o(K);var T=c(K,2);G(T);var xe=c(T,2);{var ye=r=>{var t=Ge();_(r,t)};R(xe,r=>{e(f)&&r(ye)})}o(re),o(B);var te=c(B,2);{var we=r=>{var t=Ve(),l=i(t),m=i(l,!0);o(l);var g=c(l,2);{var n=d=>{var $=Qe();Y("click",$,()=>a(v,"")),_(d,$)};R(g,d=>{e(b)&&d(n)})}o(t),y(()=>u(m,e(v))),_(r,t)};R(te,r=>{e(v)&&r(we)})}var se=c(te,2);{var Le=r=>{var t=Xe(),l=c(i(t),2),m=i(l,!0);o(l),o(t),y(()=>u(m,e(s))),_(r,t)};R(se,r=>{e(b)&&r(Le)})}var U=c(se,2),j=i(U),Pe=i(j);{var Se=r=>{var t=Ze();_(r,t)},ke=r=>{var t=Ce();y(()=>u(t,e(f)?w.submitButton:S.submitButton)),_(r,t)};R(Pe,r=>{e(p)?r(Se):r(ke,!1)})}o(j),o(U);var oe=c(U,2),J=i(oe),$e=i(J,!0);o(J),o(oe),o(z),o(Z),o(D),y(()=>{u(fe,e(f)?w.title:S.title),u(be,S.subtitle),u(_e,e(f)?w.emailLabel:S.emailLabel),H.disabled=e(p),u(he,e(f)?w.passwordLabel:S.passwordLabel),He(T,"autocomplete",e(f)?"new-password":"current-password"),T.disabled=e(p),j.disabled=e(p),J.disabled=e(p),u($e,e(f)?S.alreadyHaveAccount+" Sign in":S.needAccount+" Register")}),Q(H,()=>e(P),r=>a(P,r)),Q(T,()=>e(x),r=>a(x,r)),Y("click",J,pe),Y("submit",z,Ue(function(...r){var t;(t=e(f)?ue:me)==null||t.apply(this,r)})),_(ce,D),De()}export{ua as component};
