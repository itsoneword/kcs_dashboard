import{c as Mt,a as h,f as E}from"../chunks/z1_h_S-m.js";import{i as Dt}from"../chunks/CKvl8f00.js";import{p as $t,m as _,o as Lt,f as Ve,a as Ft,$ as jt,s as l,g as e,c as a,b as r,r as t,d as k,e as O,t as D,i as be,n as It}from"../chunks/DO95TrpH.js";import{h as Nt,s as x,e as $}from"../chunks/DePN81sB.js";import{i as P}from"../chunks/i89i58Dp.js";import{e as ze,i as Ye}from"../chunks/KzdxLMOR.js";import{s as Ge,r as Tt}from"../chunks/B0rVqcg2.js";import{b as qt}from"../chunks/CoGRtSRs.js";import{b as ye}from"../chunks/DWPWRXnJ.js";import{p as Bt}from"../chunks/Bfc47y5P.js";import{g as we}from"../chunks/BvPgAsJ_.js";import{a as Ke,b as q}from"../chunks/VlzhU-cE.js";import{S as ke}from"../chunks/TRfbXqLr.js";var Rt=E('<div class="flex items-center justify-center min-h-screen"><div class="text-center"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"></div> <p class="mt-4 text-gray-600">Loading evaluations...</p></div></div>'),Ht=E('<div class="p-6 text-center"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <h3 class="mt-2 text-sm font-medium text-gray-900">No evaluations</h3> <p class="mt-1 text-sm text-gray-500">Get started by creating a new evaluation.</p> <div class="mt-6"><button class="btn-primary"><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg> New Evaluation</button></div></div>'),Jt=E('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"> </span></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-500"> </div></td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium"><a class="text-primary-600 hover:text-primary-900 mr-4">Edit</a> <a class="text-gray-600 hover:text-gray-900">View Stats</a></td></tr>'),Ot=E('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Engineer</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Coach</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Lead</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quarter</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cases</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Created</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),Pt=E("<option> </option>"),Qt=E('<div class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"><div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"><div class="mt-3"><h3 class="text-lg font-medium text-gray-900 mb-4">Create New Evaluation</h3> <form><div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-1">Engineer</label> <select required class="input"><option>Select Engineer</option><!></select></div> <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-1">Evaluation Date</label> <input type="date" required class="input"/></div> <div class="flex justify-end space-x-3"><button type="button" class="btn-secondary">Cancel</button> <button type="submit" class="btn-primary">Create Evaluation</button></div></form></div></div></div>'),Vt=E('<div class="min-h-screen bg-gray-50"><nav class="bg-white shadow-sm border-b border-gray-200"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex justify-between h-16"><div class="flex items-center space-x-4"><a href="/dashboard" class="text-primary-600 hover:text-primary-700"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg></a> <h1 class="text-xl font-semibold text-gray-900">Coach Evaluations</h1></div> <div class="flex items-center space-x-4"><span class="text-sm text-gray-700"> </span> <span class="badge badge-coach">Coach</span> <button class="btn-secondary text-sm">Logout</button></div></div></div></nav> <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"><div class="px-4 py-6 sm:px-0"><div class="flex justify-between items-center mb-6"><div><h2 class="text-2xl font-bold text-gray-900">Evaluations</h2> <p class="text-gray-600">Manage and create engineer evaluations</p></div> <button class="btn-primary"><svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg> New Evaluation</button></div> <div class="card p-4 mb-6"><h3 class="text-lg font-medium text-gray-900 mb-4">Filters</h3> <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Engineer</label> <!></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">Coach</label> <!></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">Team Lead</label> <!></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">Year</label> <select class="input"><option>2024</option><option>2023</option><option>2025</option></select></div> <div><label class="block text-sm font-medium text-gray-700 mb-1">Month</label> <select class="input"><option>All Months</option><option>January</option><option>February</option><option>March</option><option>April</option><option>May</option><option>June</option><option>July</option><option>August</option><option>September</option><option>October</option><option>November</option><option>December</option></select></div> <div class="flex items-end"><button class="btn-secondary w-full">Apply Filters</button></div></div></div> <div class="card"><div class="px-6 py-4 border-b border-gray-200"><h3 class="text-lg font-medium text-gray-900">Recent Evaluations</h3></div> <!></div></div></div></div> <!>',1);function sa(Ue,We){$t(We,!1);let C=_(null),L=_(!0),B=_([]),R=_([]),Ee=_([]),Ce=_([]),F=_(!1),o=_({engineer_id:"",coach_user_id:"",lead_user_id:"",year:new Date().getFullYear().toString(),month:""}),v=_({engineer_id:0,evaluation_date:new Date().toISOString().split("T")[0]});Lt(()=>Ke.subscribe(n=>{var u,c,j;!n.isAuthenticated&&!n.isLoading?we("/login"):n.isAuthenticated&&(l(C,n.user),!((u=e(C))!=null&&u.is_coach)&&!((c=e(C))!=null&&c.is_lead)&&!((j=e(C))!=null&&j.is_admin)?we("/dashboard"):Se())}));async function Se(){try{l(L,!0);const[i,n,u]=await Promise.all([q.getAllEvaluations(Ae()),q.getEngineersForEvaluation(),q.getAllUsers()]);l(B,i.evaluations),l(R,n.engineers),l(Ee,u.users.filter(c=>c.is_coach)),l(Ce,u.users.filter(c=>c.is_lead||c.is_admin))}catch(i){console.error("Error loading data:",i)}finally{l(L,!1)}}function Ae(){const i={};return e(o).engineer_id&&(i.engineer_id=parseInt(e(o).engineer_id)),e(o).coach_user_id&&(i.coach_user_id=parseInt(e(o).coach_user_id)),e(o).lead_user_id&&(i.lead_user_id=parseInt(e(o).lead_user_id)),e(o).year&&(i.year=parseInt(e(o).year)),e(o).month&&(i.month=parseInt(e(o).month)),i}async function Xe(){try{l(L,!0);const i=await q.getAllEvaluations(Ae());l(B,i.evaluations)}catch(i){console.error("Error applying filters:",i)}finally{l(L,!1)}}async function Ze(){var i,n;try{if(!e(v).engineer_id||!e(v).evaluation_date){alert("Please fill in all required fields");return}await q.createEvaluation(e(v)),l(F,!1),l(v,{engineer_id:0,evaluation_date:new Date().toISOString().split("T")[0]}),await Se()}catch(u){console.error("Error creating evaluation:",u),alert(((n=(i=u.response)==null?void 0:i.data)==null?void 0:n.error)||"Failed to create evaluation")}}function Me(i){return new Date(i).toLocaleDateString()}function et(i){const n=new Date(i).getMonth()+1;return`Q${Math.ceil(n/3)}`}async function tt(){await Ke.logout(),we("/login")}Dt();var De=Mt();Nt(i=>{jt.title="Coach Evaluations - KCS Portal"});var at=Ve(De);{var rt=i=>{var n=Rt();h(i,n)},it=(i,n)=>{{var u=c=>{var j=Vt(),Q=Ve(j),V=a(Q),$e=a(V),Le=a($e),Fe=r(a(Le),2),z=a(Fe),st=a(z);t(z);var ot=r(z,4);t(Fe),t(Le),t($e),t(V);var je=r(V,2),Ie=a(je),Y=a(Ie),nt=r(a(Y),2);t(Y);var G=r(Y,2),Ne=r(a(G),2),K=a(Ne),lt=r(a(K),2);const dt=O(()=>e(R).map(s=>({id:s.id,name:s.name})));ke(lt,{get options(){return e(dt)},placeholder:"Select Engineer...",emptyText:"All Engineers",get value(){return e(o).engineer_id},set value(s){k(o,e(o).engineer_id=s)},$$legacy:!0}),t(K);var U=r(K,2),vt=r(a(U),2);const ct=O(()=>e(Ee).map(s=>({id:s.id,name:s.name})));ke(vt,{get options(){return e(ct)},placeholder:"Select Coach...",emptyText:"All Coaches",get value(){return e(o).coach_user_id},set value(s){k(o,e(o).coach_user_id=s)},$$legacy:!0}),t(U);var W=r(U,2),pt=r(a(W),2);const ut=O(()=>e(Ce).map(s=>({id:s.id,name:s.name})));ke(pt,{get options(){return e(ut)},placeholder:"Select Lead...",emptyText:"All Leads",get value(){return e(o).lead_user_id},set value(s){k(o,e(o).lead_user_id=s)},$$legacy:!0}),t(W);var X=r(W,2),Z=r(a(X),2);D(()=>{e(o),be(()=>{})});var ee=a(Z);ee.value=ee.__value="2024";var te=r(ee);te.value=te.__value="2023";var Te=r(te);Te.value=Te.__value="2025",t(Z),t(X);var ae=r(X,2),re=r(a(ae),2);D(()=>{e(o),be(()=>{})});var ie=a(re);ie.value=ie.__value="";var se=r(ie);se.value=se.__value="1";var oe=r(se);oe.value=oe.__value="2";var ne=r(oe);ne.value=ne.__value="3";var le=r(ne);le.value=le.__value="4";var de=r(le);de.value=de.__value="5";var ve=r(de);ve.value=ve.__value="6";var ce=r(ve);ce.value=ce.__value="7";var pe=r(ce);pe.value=pe.__value="8";var ue=r(pe);ue.value=ue.__value="9";var me=r(ue);me.value=me.__value="10";var _e=r(me);_e.value=_e.__value="11";var qe=r(_e);qe.value=qe.__value="12",t(re),t(ae);var Be=r(ae,2),mt=a(Be);t(Be),t(Ne),t(G);var Re=r(G,2),_t=r(a(Re),2);{var xt=s=>{var p=Ht(),g=r(a(p),6),f=a(g);t(g),t(p),$("click",f,()=>l(F,!0)),h(s,p)},gt=s=>{var p=Ot(),g=a(p),f=r(a(g));ze(f,5,()=>e(B),Ye,(I,d)=>{var b=Jt(),y=a(b),H=a(y),N=a(H,!0);t(H),t(y);var S=r(y),T=a(S),xe=a(T,!0);t(T),t(S);var m=r(S),A=a(m),w=a(A,!0);t(A),t(m);var M=r(m),J=a(M),bt=a(J,!0);t(J),t(M);var ge=r(M),He=a(ge),yt=a(He,!0);t(He),t(ge);var he=r(ge),Je=a(he),wt=a(Je);t(Je),t(he);var fe=r(he),Oe=a(fe),kt=a(Oe,!0);t(Oe),t(fe);var Pe=r(fe),Qe=a(Pe),Et=r(Qe,2);t(Pe),t(b),D((Ct,St,At)=>{x(N,e(d).engineer_name),x(xe,e(d).coach_name),x(w,e(d).lead_name||"N/A"),x(bt,Ct),x(yt,St),x(wt,`${(e(d).case_count||0)??""} cases`),x(kt,At),Ge(Qe,"href",`/coach/evaluations/${e(d).id??""}`),Ge(Et,"href",`/reports/engineer/${e(d).engineer_id??""}`)},[()=>Me(e(d).evaluation_date),()=>et(e(d).evaluation_date),()=>Me(e(d).created_at)],O),h(I,b)}),t(f),t(g),t(p),h(s,p)};P(_t,s=>{e(B).length===0?s(xt):s(gt,!1)})}t(Re),t(Ie),t(je),t(Q);var ht=r(Q,2);{var ft=s=>{var p=Qt(),g=a(p),f=a(g),I=r(a(f),2),d=a(I),b=r(a(d),2);D(()=>{e(v),be(()=>{e(R)})});var y=a(b);y.value=y.__value=0;var H=r(y);ze(H,1,()=>e(R),Ye,(m,A)=>{var w=Pt(),M={},J=a(w,!0);t(w),D(()=>{M!==(M=e(A).id)&&(w.value=(w.__value=e(A).id)??""),x(J,e(A).name)}),h(m,w)}),t(b),t(d);var N=r(d,2),S=r(a(N),2);Tt(S),t(N);var T=r(N,2),xe=a(T);It(2),t(T),t(I),t(f),t(g),t(p),ye(b,()=>e(v).engineer_id,m=>k(v,e(v).engineer_id=m)),qt(S,()=>e(v).evaluation_date,m=>k(v,e(v).evaluation_date=m)),$("click",xe,()=>l(F,!1)),$("submit",I,Bt(Ze)),h(s,p)};P(ht,s=>{e(F)&&s(ft)})}D(()=>x(st,`Welcome, ${e(C).name??""}`)),$("click",ot,tt),$("click",nt,()=>l(F,!0)),ye(Z,()=>e(o).year,s=>k(o,e(o).year=s)),ye(re,()=>e(o).month,s=>k(o,e(o).month=s)),$("click",mt,Xe),h(c,j)};P(i,c=>{e(C)&&c(u)},n)}};P(at,i=>{e(L)?i(rt):i(it,!1)})}h(Ue,De),Ft()}export{sa as component};
